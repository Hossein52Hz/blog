+++
title = "راه اندازی شبیه ساز NS3 بوسیله Docker"
description = ""
author = ""
date = 2019-05-10T14:49:43+04:30
tags = []
draft = true
+++

واقعیتش این پست را برای یادآوری و آرشیو دارم می نویسم و برای همین خیلی جامع نیست.
مشکلی که برای من پیش اومده این هست که نیاز به نصب و راه اندازی NS3-26 دارم در حالی که سیستم عامل فعلیم لینوکس مینت نسخه ۱۹ هست.
حالا مشکلی که برخوردم این هست که شبیه ساز NS3 نسخه 26 یک سری ابزار همراهش باید نصب بشه که با کرنل نسخه مینت ۱۹ مشکل داره.
یک روش هم هست برای نصب این نسخه از شبیه ساز توی کرنل های نسخه های بالاتر مثل همین مینت ۱۹ که در واقع مربوط به نسخه های جدیدتر کامپایلر هست هم میتونید [اینجا](https://www.nsnam.org/wiki/HOWTO_build_old_versions_of_ns-3_on_newer_compilers) پیدا کنید.

با این روش به نظر کامپایل درست تمام میشه ولی موقع اجرای کدهای شبیه سازی کمی دچار مشکل میشه.

خلاصه از این جریان ها بگذریم من رفتم سراغ داکر تا بوسیله داکر یک ایمیج از ابونتو 16.04 را بگیرم و روش ns3-26 را نصب کنم و کارم راه بیافته.

برای اینکار ابتدا خود docker و docker-compose را نصب کردم.
توی [این لینک](https://docs.docker.com/compose/install/) میتونید راهنمای نصبش را مطالعه کنید.

برای مطالعه و دیدن آموزش های فارسی داکر هم میتونید به سایت [dockerme](https://dockerme.ir) مراجعه کنید فکر میکنم منبع خوبیه.

خب چندتا از دستورات ضروری که نیاز دارم را مینویسم اینجا 
ابتدا برای گرفتن ایمیج ابونتو ۱۶۰۴ از دستور زیر استفاده می کنیم

{{< highlight shell >}}

docker pull dokken/ubuntu-16.04

{{< / highlight >}}

بعد از این کار برای ایجاد یک کانتینر جدید از این ایمیج میتونید از دستور زیر استفاده کنید

{{< highlight shell >}}

docker run -it --name ubuntu dokken/ubuntu-16.04

{{< / highlight >}}

با این دستور شما کانتینر را اجرا میکنید و ترمینال فعلی تون باید به ترمینال این کانتینر تغییر پیدا  کنه. اما مشکل اساسی که من بهش برخوردم و برای ایمیج های جدید مثل ابونتو ۱۸.۰۴ این مشکل وجود نداشت ولی برای ابونتو ۱۶.۰۴ مشکل پیش میاد خطای زیر هست:

{{< highlight shell >}}

[!!!!!!] Failed to mount API filesystems, freezing

{{< / highlight >}}

برای حل این مشکل جست و جوی زیادی انجام دادم و به این راه حل رسیدم که با دستور زیر این مشکل حل میشه که بعدا سر فرصت در مورد سوئیچ های استفاده شده داخل دستور توضیح میدم.

{{< highlight shell >}}

docker run -d --name myubuntu --security-opt seccomp=unconfined --tmpfs /run --tmpfs /run/lock -v /sys/fs/cgroup:/sys/fs/cgroup:ro -t dokken/ubuntu-16.04

{{< / highlight >}}

اگر هم جزئیات بیشتری میخواهید در مورد این سوئیچ ها بدونید میتونید به [اینجا](https://github.com/solita/docker-systemd#configuring-the-docker-host) مراجعه کنید.

خب با اجرای دستور بالا کانتینر بدون مشکل ایجاد میشه. حالا وقتشه که وارد کانتینر بشیم و شروع به نصب NS3 و پکیج های مورد نیازش کنیم و در پایان هم کامپایل کنیم.
یادتون باشه هرچیزی که داخل این کانتینر نصب میکنید در پایان که کانتینر را حذف کنید از بین میره که برای جلو گیری از این کار میشه یک بک آپ گرفت ازش که جلوتر در موردش میگم.




